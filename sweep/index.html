<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Sweep Jobs - InstrumentControl.jl</title>
      
      
      
      
        <meta name="author" content="Andrew Keller, Vinicius Ferreira">
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="InstrumentControl.jl">
    <meta property="og:image" content="None/../">
    <meta name="apple-mobile-web-app-title" content="InstrumentControl.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../assets/Documenter.css">
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-indigo palette-accent-blue">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Overview <i class="icon icon-link"></i>
              
            
          </span>
        
        Sweep Jobs
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/PainterQubits/InstrumentControl.jl" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          InstrumentControl.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          PainterQubits/InstrumentControl.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/PainterQubits/InstrumentControl.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/PainterQubits/InstrumentControl.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Overview</span>
    <ul>
      
        
  <li>
    <a class="" title="Design Summary" href="../design/">
      Design Summary
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Instruments/Measurements" href="../ins_meas/">
      Instruments/Measurements
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Sweep Jobs" href="./">
      Sweep Jobs
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Prerequisites for a Sweep" href="#prerequisites-for-a-sweep">
                Prerequisites for a Sweep
              </a>
            </li>
          
            <li class="anchor">
              <a title="Queueing" href="#queueing">
                Queueing
              </a>
            </li>
          
            <li class="anchor">
              <a title="Interacting with a sweep job" href="#interacting-with-a-sweep-job">
                Interacting with a sweep job
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        
  <li>
    <a class="" title="Implementation" href="../implementation/">
      Implementation
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Instruments</span>
    <ul>
      
        
  <li>
    <a class="" title="Alazar digitizers" href="../Alazar/">
      Alazar digitizers
    </a>
    
  </li>

      
        
  <li>
    <span class="section">Waveform generators</span>
    <ul>
      
        
  <li>
    <a class="" title="AWG5014C" href="../waveform_generator/awg5014c/">
      AWG5014C
    </a>
    
  </li>

      
    </ul>
  </li>

      
        
  <li>
    <span class="section">VNAs</span>
    <ul>
      
        
  <li>
    <a class="" title="VNAs" href="../vna/vna/">
      VNAs
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="E5071C" href="../vna/e5071c/">
      E5071C
    </a>
    
  </li>

      
    </ul>
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Miscellaneous</span>
    <ul>
      
        
  <li>
    <a class="" title="Documentation building" href="../docbuild/">
      Documentation building
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Release notes" href="../releases/">
      Release notes
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="License" href="../LICENSE/">
      License
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p><a id='Sweeps-1'></a></p>
<h1 id="sweeps">Sweeps</h1>
<p>When thinking of measurement, one generally imagines measuring some dependent variable with respect to some independent variable that is swept across a range of values. While the devil is in the details of the measurement, with Julia's multiple dispatch functionality, it should be possible to abstract executing a "sweep" to just one function, thus affording a simple but general interface for the user to conduct his measurements.</p>
<p>Moreover, the need to automate measurements and facilitate use of the same instruments by multiple users warrants some sort of queueing structure for "sweeps", which is maintained automatically and in the background of the Julia interface that the user is using.</p>
<p>We have achieved precisely these goals in a object-oriented way with our "Sweep" portion of IntrumentControl.jl" package. Below we describe the functionality meant for the user: how to use <code>Response</code> and <code>Stimulus</code> objects as well as <code>source</code> and <code>measure</code> functions to submit a sweep, how to interact with the sweep job to see it's result, estimated time of completion, etc. In <a href="https://painterqubits.github.io/InstrumentControl.jl/implementation/">Implementation</a> we describe how exactly sweep and queueing functionality is implemented</p>
<p><a id='Prerequisites-for-a-Sweep-1'></a></p>
<h2 id="prerequisites-for-a-sweep">Prerequisites for a Sweep</h2>
<p>A sweep is submitted by the user via the <code>sweep</code> function:</p>
<div class="codehilite"><pre><span></span><span class="n">sweep</span><span class="p">{</span><span class="n">N</span><span class="p">}(</span><span class="n">dep</span><span class="p">::</span><span class="n">Response</span><span class="p">,</span> <span class="n">indep</span><span class="p">::</span><span class="n">Vararg</span><span class="p">{</span><span class="n">Tuple</span><span class="p">{</span><span class="n">Stimulus</span><span class="p">,</span> <span class="n">AbstractVector</span><span class="p">},</span> <span class="n">N</span><span class="p">};</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="n">NORMAL</span><span class="p">)</span>
</pre></div>


<p><code>sweep</code> measures a response as a function of an arbitrary number of stimuli, sourced over the values given in the <code>AbstractVector</code> input, and returns a handle to the sweep job in the form of a <code>SweepJob</code> object, which will be discussed more in detail in <a href="https://painterqubits.github.io/InstrumentControl.jl/implementation/">Implementation</a>. This can be used to access the results while the sweep is being measured. <code>priority</code> is an <code>Int</code> from 0 to <code>typemax(Int)</code>, inclusive, and is used to prioritize the next sweep in a queue (with multiple sweeps) to be run. It is typically one of the following:</p>
<ul>
<li><code>HIGH == 10</code></li>
<li><code>NORMAL == 5</code></li>
<li><code>LOW == 0</code></li>
</ul>
<p>Thus, the <code>priority</code> keyword argument may be <code>LOW</code>, <code>NORMAL</code>, or <code>HIGH</code>, or any integer greater than or equal to zero.</p>
<p>The <code>sweep</code> functions assumes that appropriate <code>measure</code> methods have been written for the dep object passed, and that appropriate <code>source</code> methods have been written for all <code>Stimulus</code> objects in the passed <code>indep</code> argument. Thus, to use the function the user must have defined <code>Response</code> and <code>Stimulus</code> subtypes, as well as <code>source</code> and <code>measure</code> functions for those types.</p>
<p>For example, ... put example here with definition of <code>Stimulus</code>, <code>source</code>, <code>response</code>, <code>measure</code>, and <code>sweep</code></p>
<p><a id='Queueing-1'></a></p>
<h2 id="queueing">Queueing</h2>
<p>InstrumentControl employs a queueing structure for job handling through manipulation of <code>SweepJob</code> objects, which are instantiated when the <code>sweep</code> function is used. The actual "queue" is a <code>SweepJobQueue</code> object, described more in detail in <a href="https://painterqubits.github.io/InstrumentControl.jl/implementation/">Implementation</a> When the InstrumentControl package is imported by the user, a 'SweepJobQueue' object, as well as communication with the database set up by <a href="https://github.com/PainterQubits/ICDataServer.jl">ICDataServer.jl</a>, is automatically initialized; in the documentation this object is referred to as the "default sweep job queue object".</p>
<p>When <code>sweep</code> is used, a job ID is automatically obtained for the new sweep job (which exists in Julia as a <code>SweepJob</code> object) via communication with the database; the job is then put into the queue with the job ID as it's identifier. In essence, a <code>SweepJobQueue</code> object can be thought of as a <em>collection</em> (in the Julia sense) of <code>SweepJob</code> objects, indexed by their job ID, along with other fields and helper functions for automatic scheduling of jobs in the background. The queue prioritizes jobs based on their priorities; for equal priority values, the job submitted earlier takes precedent</p>
<p><a id='Interacting-with-a-sweep-job-1'></a></p>
<h2 id="interacting-with-a-sweep-job">Interacting with a sweep job</h2>
<p>When <code>sweep</code> is called, the returned <code>SweepJob</code> object displays it's job ID as well as it's status (waiting, running, done, etc), priority, progress (percentage of job completed), and time of submission. Both the job ID and the returned <code>SweepJob</code> object itself can be used to interact with the job in the following ways:</p>
<p><a id='Base.eta' href='#Base.eta'>#</a>
<strong><code>Base.eta</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>eta(x::SweepJob)
</pre></div>


<p>Return the estimated time of completion for sweep job <code>x</code>. It estimates this time by first calculating the amount of time passed from when the job was submitted to the time the function is called, and then calculating the ETA based on the current progress of the job and this passed time</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L146-L152' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.progress' href='#InstrumentControl.progress'>#</a>
<strong><code>InstrumentControl.progress</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>progress(x::SweepJob)
</pre></div>


<p>Returns the sweep job progress, a <code>Float64</code> between 0 and 1 (inclusive).</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L175-L178' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.jobs-Tuple{Any}' href='#InstrumentControl.jobs-Tuple{Any}'>#</a>
<strong><code>InstrumentControl.jobs</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>jobs(job_id)
</pre></div>


<p>Return the <code>SweepJob</code> object associated with <code>job_id</code> scheduled in the default sweep job queue object.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L509-L513' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.result' href='#InstrumentControl.result'>#</a>
<strong><code>InstrumentControl.result</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>result(sj::SweepJob)
</pre></div>


<p>Returns the result array of a sweep job <code>sj</code>. Throws an error if the result array has not yet been initialized.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L184-L188' class='documenter-source'>source</a><br></p>
<div class="codehilite"><pre><span></span>result(i::Integer)
</pre></div>


<p>Returns a result array by job id scheduled in the default sweep job queue object.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L516-L519' class='documenter-source'>source</a><br></p>
<div class="codehilite"><pre><span></span>result()
</pre></div>


<p>Returns the result array from the last finished or aborted job scheduled in the default sweep job queue object.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L522-L526' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.abort!' href='#InstrumentControl.abort!'>#</a>
<strong><code>InstrumentControl.abort!</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>abort!(x::SweepJob)
</pre></div>


<p>Abort a sweep job. Practically, the status of the job is changed to "Aborted", and the job is put into the update_channel of the default <code>SweepJobQueue</code> object. This automatically leads to: update of job metadata in the <code>SweepJob</code> object as well as in the ICDatabase, update of queue metadata, archieving of the job's result array, and start of the highest priority job in the default sweep job queue. Thus, aborting a job is guaranteed to bail out of the sweep in such a way that the data that has been measured for most recent sourcing of a stimulus, i.e. at the very start of a for loop in <a href="../implementation/#InstrumentControl._sweep!"><code>InstrumentControl._sweep!</code></a>, is archieved. You can also abort a sweep before it even begins.</p>
<p>Presently this function does not interrupt <code>measure</code>, so if a single measurement takes a long time then the sweep is only aborted after that finishes.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L535-L549' class='documenter-source'>source</a><br></p>
<div class="codehilite"><pre><span></span>abort!()
</pre></div>


<p>Abort the currently running job (if any). If no job is running, the method does not throw an error.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L568-L572' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.prune!' href='#InstrumentControl.prune!'>#</a>
<strong><code>InstrumentControl.prune!</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>prune!(q::SweepJobQueue)
</pre></div>


<p>Prunes a <a href="../implementation/#InstrumentControl.SweepJobQueue"><code>SweepJobQueue</code></a> of all <a href="../implementation/#InstrumentControl.SweepJob"><code>InstrumentControl.SweepJob</code></a>s with a status of <code>Done</code> or <code>Aborted</code>. This will have the side effect of releasing old sweep results if there remain no references to them in julia, however they should still be saved to disk and can be recovered later.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/3e75bb51608ac74a11983adff3df37fb3f06fedf/src/Sweep.jl#L581-L587' class='documenter-source'>source</a><br></p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../ins_meas/" title="Instruments/Measurements">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Instruments/Measurements
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../implementation/" title="Implementation">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Implementation
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = 'PainterQubits/InstrumentControl.jl';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
      <script src="../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>