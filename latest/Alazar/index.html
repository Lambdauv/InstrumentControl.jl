
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Package for instrument control and superconducting qubit measurement.">
      
      
      
        <meta name="author" content="Andrew Keller, Vinicius Ferreira">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.0">
    
    
      
        <title>Alazar digitizers - InstrumentControl.jl</title>
      
    
    
      <script src="../assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-b6a6d08807.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/Documenter.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="InstrumentControl.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon md-icon--home"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Instruments
                </span>
              
            
            Alazar digitizers
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/PainterQubits/InstrumentControl.jl" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </div>
    InstrumentControl.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/PainterQubits/InstrumentControl.jl" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../design/" title="Design Summary" class="md-nav__link">
      Design Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ins_meas/" title="Instruments/Measurements" class="md-nav__link">
      Instruments/Measurements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sweep/" title="Sweep Jobs" class="md-nav__link">
      Sweep Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Instruments
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Instruments
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Alazar digitizers
      </label>
    
    <a href="./" title="Alazar digitizers" class="md-nav__link md-nav__link--active">
      Alazar digitizers
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details" title="Technical details" class="md-nav__link">
    Technical details
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digitizer-requirements" title="Digitizer requirements" class="md-nav__link">
    Digitizer requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-allocate-appropriate-buffers-in-julia" title="How to allocate appropriate buffers in Julia" class="md-nav__link">
    How to allocate appropriate buffers in Julia
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Waveform generators
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Waveform generators
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../waveform_generator/awg5014c/" title="AWG5014C" class="md-nav__link">
      AWG5014C
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      VNAs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        VNAs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../vna/vna/" title="VNAs" class="md-nav__link">
      VNAs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vna/e5071c/" title="E5071C" class="md-nav__link">
      E5071C
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Miscellaneous
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../docbuild/" title="Documentation and testing" class="md-nav__link">
      Documentation and testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../releases/" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../LICENSE/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details" title="Technical details" class="md-nav__link">
    Technical details
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digitizer-requirements" title="Digitizer requirements" class="md-nav__link">
    Digitizer requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-allocate-appropriate-buffers-in-julia" title="How to allocate appropriate buffers in Julia" class="md-nav__link">
    How to allocate appropriate buffers in Julia
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/PainterQubits/InstrumentControl.jl/edit/master/docs/Alazar.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='Alazar-digitizers-1'></a></p>
<h1 id="alazar-digitizers">Alazar digitizers</h1>
<p>We put all Alazar digitizers in module <code>AlazarModule</code>; the feature set and API is so similar for the various models that just one module makes sense.</p>
<p>An <a href="./#InstrumentControl.AlazarModule.AlazarResponse"><code>AlazarResponse</code></a> type is given for each measurement mode of the digitizer. ("Traditional record mode" has not been implemented yet for lack of immediate need.) Additionally, one can define custom <code>AlazarResponse</code> types so that some custom computations or data reductions can be performed during acquisition. <a href="./#InstrumentControl.AlazarModule.IQSoftwareResponse"><code>IQSoftwareResponse</code></a> is a good example of this.</p>
<p>In the following discussion, it is important to understand some Alazar terminology. Newer Alazar digitizers use direct memory access (DMA) to stream data into a computer's RAM. A single <em>acquisition</em> uses one or many <em>buffers</em>, which constitute preallocated regions in the computer's physical memory. Each buffer contains one or many <em>records</em>. Each <em>record</em> contains many <em>samples</em>, which are the voltages measured by the digitizer. In streaming mode, there is only one record per buffer, but in other modes there can be many records per buffer.</p>
<p>Looking at the source code, it would seem that there is some redundancy in the types, for instance there is an <code>NPTRecordMode</code> and an <code>NPTRecordResponse</code> object. The former is used internally in the code to denote a particular method of configuring the instrument, mirroring the terminology used in the Alazar API documentation. The latter specifies what you actually want to do using that configuration of the instrument. Perhaps you want to measure in a given mode, but do some custom post-processing or processing during acquisition. <code>IQSoftwareResponse</code> is an example of this: it uses <code>NPTRecordMode</code> but reduces the data during measurement. Typically the user doesn't have to deal with the various mode objects, unless developing a new <code>AlazarResponse</code> type.</p>
<p><a id='Usage-1'></a></p>
<h2 id="usage">Usage</h2>
<p>Here are the currently defined <code>AlazarResponse</code> types you can use:</p>
<p><a id='InstrumentControl.AlazarModule.ContinuousStreamResponse' href='#InstrumentControl.AlazarModule.ContinuousStreamResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.ContinuousStreamResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct ContinuousStreamResponse{S,T} &lt;: StreamResponse{S,T}
</pre></div>


<p>Response type implementing the "continuous streaming mode" of the Alazar API.</p>
<p>Usage example:</p>
<div class="codehilite"><pre><span></span>ats = AlazarATS9870()
samples_per_ch = 1024
res = ContinuousStreamResponse(ats, samples_per_ch)
measure(res)
</pre></div>


<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L34-L45' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.AlazarModule.TriggeredStreamResponse' href='#InstrumentControl.AlazarModule.TriggeredStreamResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.TriggeredStreamResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct TriggeredStreamResponse{S,T} &lt;: StreamResponse{S,T}
</pre></div>


<p>Response type implementing the "triggered streaming mode" of the Alazar API.</p>
<p>Usage example:</p>
<div class="codehilite"><pre><span></span>ats = AlazarATS9870()
samples_per_ch = 1024
res = TriggeredStreamResponse(ats, samples_per_ch)
measure(res)
</pre></div>


<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L61-L72' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.AlazarModule.NPTRecordResponse' href='#InstrumentControl.AlazarModule.NPTRecordResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.NPTRecordResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct NPTRecordResponse{S,T} &lt;: RecordResponse{S,T}
</pre></div>


<p>Response type implementing the "NPT record mode" of the Alazar API.</p>
<p>Usage example:</p>
<div class="codehilite"><pre><span></span>ats = AlazarATS9870()
samples_per_rec_per_ch = 1024
total_recs = 10
res = NPTRecordResponse(ats, sam_per_rec_per_ch, total_recs)
measure(res)
</pre></div>


<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L88-L100' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.AlazarModule.FFTHardwareResponse' href='#InstrumentControl.AlazarModule.FFTHardwareResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.FFTHardwareResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct FFTHardwareResponse{S,T,U} &lt;: FFTResponse{S,T}
</pre></div>


<p>Response type implementing the FPGA-based "FFT record mode" of the Alazar API. Not all Alazar digitizers support this mode.</p>
<p>Usage example:</p>
<div class="codehilite"><pre><span></span>ats = AlazarATS9360()
samples_per_rec = 1024
sam_per_fft = 512
total_recs = 10
res = FFTHardwareResponse(ats, sam_per_rec, sam_per_fft, total_recs, Alazar.S32Real)
measure(res)
</pre></div>


<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L118-L132' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.AlazarModule.IQSoftwareResponse' href='#InstrumentControl.AlazarModule.IQSoftwareResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.IQSoftwareResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct IQSoftwareResponse{S,T} &lt;: RecordResponse{S,T}
</pre></div>


<p>Response type for measuring with NPT record mode and mixing in software to find the phase and amplitude of a component at frequency <code>f</code>. Slower than doing it in an FPGA, but ultimately necessary if we want to use both channels as inputs to the FFT.</p>
<p>Usage example:</p>
<div class="codehilite"><pre><span></span>ats = AlazarATS9870()
samples_per_rec_per_ch = 1024
total_recs = 10
f = 100e6
res = IQSoftwareResponse(ats, samples_per_rec_per_ch, total_recs, f)
measure(res)
</pre></div>


<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L155-L170' class='documenter-source'>source</a><br></p>
<p>These definitions referenced some abstract types, described here:</p>
<p><a id='InstrumentControl.AlazarModule.AlazarResponse' href='#InstrumentControl.AlazarModule.AlazarResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.AlazarResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>abstract type AlazarResponse{S,T} &lt;: Response
</pre></div>


<p>Abstract <code>Response</code> from an Alazar digitizer instrument. Subtypes should implement <code>return_type</code> to specify the output array type if they rely on the generic method <code>measure(::AlazarResponse)</code>.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L7-L12' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.AlazarModule.StreamResponse' href='#InstrumentControl.AlazarModule.StreamResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.StreamResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>abstract type StreamResponse{S,T} &lt;: AlazarResponse{S,T}
</pre></div>


<p>Abstract time-domain streaming <code>Response</code> from an Alazar digitizer instrument.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L16-L19' class='documenter-source'>source</a><br></p>
<p><a id='InstrumentControl.AlazarModule.RecordResponse' href='#InstrumentControl.AlazarModule.RecordResponse'>#</a>
<strong><code>InstrumentControl.AlazarModule.RecordResponse</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>abstract type RecordResponse{S,T} &lt;: AlazarResponse{S,T}
</pre></div>


<p>Abstract time-domain record <code>Response</code> from an Alazar digitizer instrument.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/InstrumentControl.jl/tree/ca08e5d51b1d59961cd78a90990fd843f5b150ae/src/instruments/Digitizers/Alazar/ResponseTypes.jl#L22-L25' class='documenter-source'>source</a><br></p>
<p><a id='Technical-details-1'></a></p>
<h2 id="technical-details">Technical details</h2>
<p><a id='Digitizer-requirements-1'></a></p>
<h3 id="digitizer-requirements">Digitizer requirements</h3>
<p>The Alazar digitizers expect buffers in physical memory which are page-aligned. The size of each buffer should also be chosen appropriately.</p>
<p>The behavior of the digitizer is not specified when the buffer is made larger than 64 MB. On our computer, it seems like an <code>ApiWaitTimeout</code> error is thrown when the buffer is too large (for some unspecified definition of "large" greater than 64 MB). The digitizer will then throw <code>ApiInsufficientResources</code> errors whenever another acquisition is attempted, until the computer is restarted. Just restarting the Julia kernel, forcing a reload of the Alazar DLLs, does not appear to be enough to reset the digitizer fully.</p>
<p>For performance reasons, a buffer should not be made much smaller than 1 MB if mulitple buffers are required. There is also a minimum record size for each model of digitizer. For the ATS9360, if a record has fewer than 256 samples (could be 128 from channel A + 128 from channel B) then the acquisition will proceed, but return garbage data. Allocating too small of a buffer is therefore still bad, but less fatal than allocating one that is too large.</p>
<p><a id='How-to-allocate-appropriate-buffers-in-Julia-1'></a></p>
<h3 id="how-to-allocate-appropriate-buffers-in-julia">How to allocate appropriate buffers in Julia</h3>
<p>In Julia, just allocating an array will not necessarily return a page-aligned block in memory. The Alazar.jl package provides two array types to help with this. These arrays are not required to be created by the user.</p>
<ul>
<li><code>Alazar.PageAlignedVector</code> is just like <code>Base.Vector</code> except that the memory backing the array is guaranteed to be page-aligned.</li>
<li>The elements of an <code>Alazar.DMABufferVector</code> are pointers to different locations in memory which are page-aligned and can act as DMA buffers. The array is iterable and indexable as usual. The <code>Alazar.DMABufferVector</code> must itself be backed by a page-aligned array type, like <code>Alazar.PageAlignedVector</code> or <code>Base.SharedVector</code> (although support for <code>Base.SharedVector</code> is absent in InstrumentControl).</li>
</ul>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../implementation/" title="Implementation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Implementation
              </span>
            </div>
          </a>
        
        
          <a href="../waveform_generator/awg5014c/" title="AWG5014C" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                AWG5014C
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../assets/mathjaxhelper.js"></script>
      
    
    
      
    
  </body>
</html>